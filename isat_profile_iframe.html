<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lea's About Me</title>
    <link rel="stylesheet" href="isat_profile_iframe.css">
    <link href="https://fonts.cdnfonts.com/css/vcr-osd-mono" rel="stylesheet">
</head>
<body>
    <main id="isatprofile" class="isat__profile__main">
        <section id="titlesection" class="isat__profile__component">
            <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
            <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
            <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
            <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
            <span class="border__bar"></span>
            <span class="border__bar"></span>
            <span class="border__bar"></span>
            <span class="border__bar"></span>
            <p id="name">Siffrin</p>
            <div id="leftButton">
                <img id="repeatbutton" src="https://kongkrog.github.io/isat-profile-customizer/assets/pageDown.png" />
                <img id="repeatbuttonstatic" src="https://kongkrog.github.io/isat-profile-customizer/assets/pageDownHold.png" />
            </div>
            <div id="rightButton">  
                <img id="repeatbutton" src="https://kongkrog.github.io/isat-profile-customizer/assets/pageUp.png" />
                <img id="repeatbuttonstatic" src="https://kongkrog.github.io/isat-profile-customizer/assets/pageUpHold.png" />
            </div>
        </section>
        <section id="imagesection" class="isat__profile__component">
            <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
            <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
            <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
            <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
            <span class="border__bar"></span>
            <span class="border__bar"></span>
            <span class="border__bar"></span>
            <span class="border__bar"></span>
            <div id="profileimage" style="background-image: url('https://kongkrog.github.io/isat-profile-customizer/assets/profileImage.png');"></div>
        </section>
        <section id="profilesection" class="isat__profile__component">
            <div id="profilemenu" class="isat__profile__component">
                <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
                <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
                <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
                <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
                <span class="border__bar"></span>
                <span class="border__bar"></span>
                <span class="border__bar"></span>
                <span class="border__bar"></span>
                <img id="arrowUI" src="https://kongkrog.github.io/isat-profile-customizer/assets/arrow.png">
                <button id="profilebutton" class="active">
                    <img id="cornerUpLeft" class="corner" src="https://kongkrog.github.io/isat-profile-customizer/assets/cursorBorderA.png">
                    <img id="cornerDownRight" class="corner" src="https://kongkrog.github.io/isat-profile-customizer/assets/cursorBorderA.png">
                    <img id="cornerUpRight" class="corner" src="https://kongkrog.github.io/isat-profile-customizer/assets/cursorBorderB.png">
                    <img id="cornerDownLeft" class="corner" src="https://kongkrog.github.io/isat-profile-customizer/assets/cursorBorderB.png">
                    <img src="https://kongkrog.github.io/isat-profile-customizer/assets/sparkleicon.png" class="icon"> Profile
                </button>
                <button id="statbutton">
                    <img id="cornerUpLeft" class="corner" src="https://kongkrog.github.io/isat-profile-customizer/assets/cursorBorderA.png">
                    <img id="cornerDownRight" class="corner" src="https://kongkrog.github.io/isat-profile-customizer/assets/cursorBorderA.png">
                    <img id="cornerUpRight" class="corner" src="https://kongkrog.github.io/isat-profile-customizer/assets/cursorBorderB.png">
                    <img id="cornerDownLeft" class="corner" src="https://kongkrog.github.io/isat-profile-customizer/assets/cursorBorderB.png">
                    <img src="https://kongkrog.github.io/isat-profile-customizer/assets/staticon.png" class="icon"> Stats
                </button>
            </div>
            <div class="isat__profile__component">
                <div id="infosection">
                    <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
                    <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
                    <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
                    <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
                    <span class="border__bar"></span>
                    <span class="border__bar"></span>
                    <span class="border__bar"></span>
                    <span class="border__bar"></span>
                    <div class="text__component" style="position: relative;">
                        <p id="name">Siffrin</p>
                        <p id="pronouns" class="secondary__text">(he/they)</p>
                        <div class="icon__component">
                            <img id="craft1" class="icon__craft" src="">
                            <img id="craft2" class="icon__craft" src="">
                        </div>
                    </div>
                    <div class="text__component">
                        <p id="desc">small days small days small days small days small days small days small days small days small days small days small days small days small days small days small days small days small days small days small days small days small days small days small days small days</p>
                    </div>
                    <div class="text__component">
                        <div id="weaknessinfo">
                            <div class="weakness__text__component">
                                <p class="secondary__text">WEAK TO:</p>
                                <span>
                                    <img id="weakimg" class="icon__craft" src="https://kongkrog.github.io/isat-profile-customizer/assets/rockcraft.png">
                                    <p id="weaktext">Rock</p>
                                </span>
                            </div>
                            <div class="weakness__text__component">
                                <p class="secondary__text">RESISTANT TO:</p>
                                <span>
                                    <img id="resimg" class="icon__craft" src="https://kongkrog.github.io/isat-profile-customizer/assets/papercraft.png">
                                    <p id="restext">Rock</p>
                                </span>
                            </div>
                            <div class="weakness__text__component">
                                <p class="secondary__text"></p>
                                <span>
                                    <img id="resimg2" class="icon__craft" src="">
                                    <p id="restext2"></p>
                                </span>
                            </div>
                            <div id="immunepart" class="weakness__text__component">
                                <p class="secondary__text">IMMUNE TO:</p>
                                <span>
                                    <img id="immuneimg" class="icon__craft" src="https://kongkrog.github.io/isat-profile-customizer/assets/papercraft.png">
                                    <p id="immunetext">Paper</p>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="statsection" style="display: none;">
                    <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
                    <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
                    <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
                    <img class="corner__img" src="https://kongkrog.github.io/isat-profile-customizer/assets/uicorner.svg">
                    <span class="border__bar"></span>
                    <span class="border__bar"></span>
                    <span class="border__bar"></span>
                    <span class="border__bar"></span>
                    <div class="text__component">
                        <p id="titlename">The Traveler</p>
                        <div class="hp__text__component">
                            <span class="secondary__text">LVL<p id="level">50</p></span>
                            <span class="secondary__text">HP<p id="hp">50/50</p></span>
                        </div>
                    </div>
                    <div class="text__component">
                        <div class="stat__text__component">
                            <p class="secondary__text">Attack</p>
                            <span id="atk">294</span>
                        </div>
                        <div class="stat__text__component">
                            <p class="secondary__text">Defense</p>
                            <span id="def">294</span>
                        </div>
                        <div class="stat__text__component">
                            <p class="secondary__text">Atk Speed</p>
                            <span id="atkstd">294</span>
                        </div>
                        <div class="stat__text__component">
                            <p class="secondary__text">Luck</p>
                            <span id="luck">294</span>
                        </div>
                    </div>
                    <div class="text__component">
                        <div class="exp__text__component">
                            <p class="secondary__text">Current EXP</p>
                            <span id="exp">294</span>
                        </div>
                        <div class="exp__text__component">
                            <p class="secondary__text">To Next Level</p>
                            <span id="nextexp">294</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <script defer>
        function calculateRatio(element) {
            return element.offsetWidth / 816;
        }

        function createRatioVariable() {
            var r = document.querySelector(':root');
            r.style.setProperty('--scale-value', calculateRatio(document.getElementById("isatprofile")));
        }

        function toggleSections(sectionToShow) {
            const infoSection = document.getElementById('infosection');
            const statSection = document.getElementById('statsection');
            const statButton = document.getElementById('statbutton'); 
            const profileButton = document.getElementById('profilebutton'); 

            if (sectionToShow === 'info') {
                infoSection.style.display = 'flex';
                statSection.style.display = 'none'; 
                statButton.classList.remove("active");
                profileButton.classList.add("active");

            } else if (sectionToShow === 'stats') {
                infoSection.style.display = 'none'; 
                statSection.style.display = 'flex';
                statButton.classList.add("active");
                profileButton.classList.remove("active");
            }
        }

        document.getElementById('profilebutton').addEventListener('click', function() {
            toggleSections('info');
        });

        document.getElementById('statbutton').addEventListener('click', function() {
            toggleSections('stats');
        });

        /*
        function createUrlFromElements() {
            const params = new URLSearchParams();
            const elements = document.querySelectorAll('[id]');
        
            elements.forEach(el => {
                if (el.tagName === 'BUTTON' && el.id) {
                    return;
                }
        
                if (el.tagName === 'IMG' && el.closest('button')) {
                    return;
                }
        
                if (el.tagName === 'DIV' && (el.id === 'leftButton' || el.id === 'rightButton')) {
                    return;
                }
        
                if (el.tagName === 'IMG' && (el.closest('#leftButton') || el.closest('#rightButton') || el.closest('#arrowUI'))) {
                    return;
                }
        
                const id = el.id;
        
                if (el.tagName === 'P' || el.tagName === 'SPAN') {
                    params.set(id, el.textContent.trim());
                } else if (el.tagName === 'IMG') {
                    if (el.getAttribute('src') === "") {
                        params.set(`${id}_src`, "");
                    } else if (el.getAttribute('src') && el.getAttribute('src') !== "") {
                        params.set(`${id}_src`, el.getAttribute('src'));
                    }
                }
            });
        
            const url = `${window.location.origin}${window.location.pathname}?${params.toString()}`;
            return url;
        }
        */

        function updateElementsFromUrl() {
            const params = new URLSearchParams(window.location.search);
            let widthValue = '100%';

            params.forEach((value, key) => {
                if (key.endsWith('_src')) {
                    const imgId = key.replace('_src', ''); 
                    const imgElement = document.getElementById(imgId);
                    if (imgElement && imgElement.tagName === 'IMG') {
                        if (value) {
                            imgElement.src = value; 
                        } else {
                            imgElement.style.display = 'none'; 
                        }
                    }
                } else if (key === 'width') {
                    if (value) {
                        widthValue = value + 'px';
                    }
                } else {
                    const element = document.getElementById(key);
                    if (element) {
                        if (element.tagName === 'P' || element.tagName === 'SPAN') {
                            if (value) {
                                element.textContent = value;
                            } else {
                                element.style.display = 'none';
                            }
                        } else if (element.tagName === 'INPUT') {
                            if (value) {
                                element.value = value;
                            } else {
                                element.style.display = 'none';
                            }
                        }
                    }
                }
            });
            const root = document.documentElement;
            root.style.setProperty('--profile-size-width', widthValue);
            createRatioVariable();
        }

        function checkAndHideImmunePart() {
            const immuneImg = document.getElementById('immuneimg');
            const immuneText = document.getElementById('immunetext');
            const immunePart = document.getElementById('immunepart');
        
            const imgDisplay = window.getComputedStyle(immuneImg).display;
            const textDisplay = window.getComputedStyle(immuneText).display;
        
            if (imgDisplay === 'none' && textDisplay === 'none') {
                immunePart.style.display = 'none'; 
            } else {
                immunePart.style.display = ''; 
            }
        }
        
        /*
        Promise.all(Array.from(document.images).map(img => {
            return new Promise(resolve => {
                if (img.complete && img.src) {
                    resolve();
                } else {
                    img.onload = img.onerror = resolve;
                }
            });
        })).then(() => {
            console.log(createUrlFromElements());
        });
        */
       
        updateElementsFromUrl();
        checkAndHideImmunePart();
    </script>    
</body>
</html>
